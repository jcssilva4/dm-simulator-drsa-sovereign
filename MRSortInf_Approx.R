library(MCDA)
#Entries for MRSortInferenceApprox
#documentation_url_3 <- "https://www.rdocumentation.org/packages/MCDA/versions/0.0.20/topics/MRSortInferenceExact"

initTable <- read.xlsx("C:/Users/julio/Google Drive/1stRev DRSA_4OR/data/countryRisk_2014_MCDAcomparison.xlsx", sheetName = "Plan1")
countrNames <- initTable[, 1]
performanceTable_test <- rbind(initTable[,2:10])
rownames(performanceTable_test) <- countrNames

performanceTable <- rbind(
  c(10970.1232849014, 75.62904103026268, 29.41984502424885, 11296279513.921, 323277158906.9789, 134853702251.858, 10840.0, 4.6125, 4.430295777723746),
  c(40454.44745789028, 15.91539812343842, 24.03495652124607, 10648441636.2071, 5155717056270.827, 1266851401020.24, 48280.0, 1.30375, 1.6423991082864),
  c(7224.965171507857, 61.52261968031297, 38.51258535198782, 398456549.594684, 14901750764.98113, 7726052459.97927, 8000.0, 10.1892333333333, 7.702259867685105),
  c(15842.94080521801, 32.19947338367626, 21.51048444280762, 20824865443.2657, 278384345259.4738, 41093252538.759, 15270.0, 9.26187678192101, 7.144019590153392),
  c(20926.55404957111, 75.37484402131214, 33.50822676165136, 1612430962.28869, 78784395318.59557, 15951037291.2884, 20320.0, 5.5155, 7.200514235623412),
  c(7050.645919889634, 24.59925566274602, 48.44521278922483, 290928431467.003, 9570405758739.791, 3880368265252.93, 6770.0, 6.0, 3.75777462903133),
  c(36309.4688256886, 33.67121402846205, 22.89354394707567, 11842200000.0, 292636164000.6373, 81785518232.8202, 34310.0, 4.53433612462771, 2.176111462402201),
  c(25890.01866989056, 53.87507630581763, 34.47424663761414, 12766600000.0, 1305604981271.913, 345694098075.172, 25760.0, 4.64333333333333, 3.75793192130540),
  c(19916.01938737215, 76.87095181019235, 24.21439583631373, 7357578652.57, 209402444996.1042, 56217652210.6233, 19270.0, 4.96989301373891, 3.488049793606782),
  c(56967.42579403833, 195.077796338143, 45.51569710627191, 64389514904.4993, 307576360584.9916, 277797711589.929, 54470.0, 5.38, 5.833605870137649),
  c(52184.06185049306, 79.88047778603797, 28.06076371697084, 328683686654.696, 876923518850.4048, 46309213046.113, 52950.0, 1.5, 0.217232459170826),
  c(85050.91097168215, 72.71779686439424, 58.25201245837186, -840384615.384617, 198727747252.7473, 42082172537.965, 78800.0, 5.112674134, 3.179780935439958),
  c(23838.61439793707, 156.9825935699502, 22.98259537893911, 510408456.722476, 10154463059.24606, 596933291.286177, 22680.0, 4.705, 2.695332567172033), 
  c(25025.09956290829, 68.57822982038519, 1.366142826228091, 226371388.826816, 2581564245.810056, 653170670.0, 23970.0, 8.5, 10.99997995126551), 
  c(7875.756952542878, 48.41583307552164, 42.16728076638825, 2619437000.0, 74164435946.46272, 15175667724.097, 7410.0, 18.21, 17.7227825311853), 
  c(35549.9746972954, 28.63324307969865, 18.00055753547638, 19531411961.8185, 2141315327318.207, 145724509188.872, 35550.0, 5.14416666666667, 3.951211997463773),
  c(12300.32257522326, 11.74223284563898, 18.33663102034147, 75211028087.44, 2472806456101.294, 358816422466.118, 12810.0, 27.3916666666667, 18.49891574867216), 
  c(9637.00265000958, 48.41741474823912, 18.07151549645933, 293341671.7153, 12129642296.44251, 3490767903.76468, 10520.0, 8.5, 5.595201539718113),
  c(9555.244217331405, 39.87312171320465, 24.52245846262788, 3854819397.63757, 190949066979.1761, 48827640845.6875, 9250.0, 10.5225, 6.896313251618643), 
  c(6756.752769265565, 24.80829942085084, 21.91445645110553, 9826002544.00792, 201175469114.3269, 65766067276.3127, 6420.0, 18.13925, 16.90330806905899),
  c(6832.456890967005, 30.97134112327325, 15.36216988329349, 8232518815.62083, 366829390478.9538, 49708174893.5691, 7350.0, 8.5, 2.208786248393751), 
  c(16007.089993444, 25.79296504882325, 24.6533494372055, 69218890000.0, 2297128039058.206, 509692074388.888, 15210.0, 9.46666666666667, 3.864059040047797), 
  c(28768.02989367266, 40.19521523852801, 23.52662671476043, 382252000.0, 10562700000.0, 807408405.007461, 28380.0, 4.75, 3.176380740379167), 
  c(16973.67421310987, 23.35313642081322, 14.43460576435345, 755137014.256028, 57531233351.20889, 16280547228.7409, 15320.0, 12.4340649587399, 3.957639862865477), 
  c(7646.839865545417, 64.8781363714651, 24.06997120419808, 1989040000.0, 55555171009.77199, 19883353048.1463, 7590.0, 9.04340833333333, 9.815306625039884), 
  c(3623.911582351342, 23.92357637936048, 31.12176664001678, 23281742361.5305, 912524136718.0182, 99386826239.0833, 3730.0, 11.6575, 6.374931242121366), 
  c(981.8398791503988, 19.5378741103687, 39.74593591487466, 2602962095.36816, 149990451022.2898, 18087689200.062, 1040.0, 13.5933333333333, 5.988698613889791), 
  c(3838.185801483817, 28.35912649955389, 14.45467947820117, 346092394.393256, 11121465767.40668, 2251610255.35403, 4110.0, 15.9949873679769, 12.2168430436348), 
  c(5254.882337996158, 50.74708439106374, 32.02988194743867, -7120017424.4614, 136709862831.1937, 31500815461.6599, 4780.0, 15.8086382955866, 12.61078023610873), 
  c(3452.922000495893, 23.71968813417143, 12.27434207201931, 1353141908.0, 53851153446.69585, 7269204343.62926, 3320.0, 13.5975, 9.89784989269058), 
  c(10490.0813312933, 31.33301740657056, 13.08250062729976, 3205384976.80294, 49745088111.6953, 7330880578.95384, 9740.0, 15.1883333333333, 10.74390979151519), 
  c(13642.19778327002, 40.43457743159834, 17.77169918160843, 937309759.586375, 58056951042.08662, 17766773440.2298, 13520.0, 9.24666666666667, 8.417903769961924), 
  c(1210.38801408195, 19.92539656782063, 9.60856390303918, 1118825000.19331, 55096728047.94079, 6598881868.91412, 1130.0, 17.3134576914047, 11.54783518265453), 
  c(4623.729553889743, 41.72175007869059, 15.50504359523593, 1028019553.35, 17189491403.15017, 2823383516.08606, 4530.0, 13.5948916043986, 12.06330049658788),
  c(2908.200085480775, 44.09247948197426, 23.89093922335017, 1749612614.39791, 30659338784.37047, 14429068711.3771, 2590.0, 11.0513992821176, 4.770029983578571),
  c(13687.24610128104, 85.58445077202369, 24.38009682050063, -3772123439.3159, 135409048034.1537, 46508013997.58, 13480.0, 6.30391235390833, 3.22918038789386)
)

rownames(performanceTable) <- c("Malaysia", "Japan", "Botswana", "Chile", "Oman", "China", "Israel", "Korea_Rep", "Czech_Republic", "Singapore", "Netherlands",
                                "Qatar","Malta", "Aruba","Azerbaijan", "Italy", "Brazil", "Mauritius", "Romania", "Peru", "South_Africa", "Russian_Federation",
                                "Bahamas_The", "Uruguay", "Bulgaria","Indonesia", "Bangladesh", "Armenia", "Angola", "Guatemala", "Costa_Rica", "Croatia", "Kenya",
                                "Georgia", "Bolivia","Hungary")
colnames(performanceTable) <- colnames(performanceTable_test)

# ranks of the alternatives
Assignments <- c(1,1,1,1,1,1,1,1,1,1,1,1,
                 2,2,2,2,2,2,2,2,2,2,2,2,
                 3,3,3,3,3,3,3,3,3,3,3,3)
names(Assignments) <- rownames(performanceTable)

#criteria to max or to min
criteriaMinMax <- c("max","max","max","max","max","max","max","min","min")
names(criteriaMinMax) <- colnames(performanceTable_test)

# ranks of the categories
categoriesRanks <- c(1,2,3)
names(categoriesRanks) <- c(1,2,3)

Parameters <- MRSortInferenceApprox(performanceTable, Assignments, categoriesRanks, criteriaMinMax,
                      veto = FALSE, alternativesIDs = NULL, criteriaIDs = NULL,
                      timeLimit = 60, populationSize = 20, mutationProb = 0.1)


# Aqui, entra as alternativas para serem classificadas!
# Precisa mudar a PerformanceTable
# performance table

x <- MRSort(performanceTable_test, Parameters$profilesPerformances, 
       categoriesRanks, Parameters$criteriaWeights, criteriaMinMax,
       Parameters$majorityThreshold, criteriaVetos = NULL,
       alternativesIDs = NULL, criteriaIDs = NULL,
       categoriesIDs = NULL)

x
clsf_table <- rbind(x)
clsf_table <- t(clsf_table)

