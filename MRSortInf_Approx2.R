library(MCDA)
#Entries for MRSortInferenceApprox
#documentation_url_3 <- "https://www.rdocumentation.org/packages/MCDA/versions/0.0.20/topics/MRSortInferenceExact"

initTable <- read.xlsx("C:/Users/julio/Google Drive/1stRev DRSA_4OR/data/countryRisk_2014_MCDAcomparison.xlsx", sheetName = "Plan1")
countrNames <- initTable[, 1]
performanceTable_test <- rbind(initTable[,2:10])
rownames(performanceTable_test) <- countrNames

performanceTable <- rbind(
  c(10970.1232849014, 75.62904103026268, 29.41984502424885, 11296279513.921, 323277158906.9789, 134853702251.858, 10840.0, 4.6125, 4.430295777723746),
  c(40454.44745789028, 15.91539812343842, 24.03495652124607, 10648441636.2071, 5155717056270.827, 1266851401020.24, 48280.0, 1.30375, 1.6423991082864),
  c(7224.965171507857, 61.52261968031297, 38.51258535198782, 398456549.594684, 14901750764.98113, 7726052459.97927, 8000.0, 10.1892333333333, 7.702259867685105),
  c(15842.94080521801, 32.19947338367626, 21.51048444280762, 20824865443.2657, 278384345259.4738, 41093252538.759, 15270.0, 9.26187678192101, 7.144019590153392),
  c(20926.55404957111, 75.37484402131214, 33.50822676165136, 1612430962.28869, 78784395318.59557, 15951037291.2884, 20320.0, 5.5155, 7.200514235623412),
  c(7050.645919889634, 24.59925566274602, 48.44521278922483, 290928431467.003, 9570405758739.791, 3880368265252.93, 6770.0, 6.0, 3.75777462903133),
  c(36309.4688256886, 33.67121402846205, 22.89354394707567, 11842200000.0, 292636164000.6373, 81785518232.8202, 34310.0, 4.53433612462771, 2.176111462402201),
  c(52504.65570410904, 30.40733963906801, 21.6509862752614, 67027866778.2682, 1842018420853.095, 71937085415.7952, 52810.0, 3.0, 1.249469865789177),
  c(19916.01938737215, 76.87095181019235, 24.21439583631373, 7357578652.57, 209402444996.1042, 56217652210.6233, 19270.0, 4.96989301373891, 3.488049793606782),
  c(53106.90977031547, 13.54452443549181, 19.26164461415694, 288131000000.0, 16784849190000.0, 448508920737.711, 53940.0, 3.25, 1.469299287151923),
  c(49388.20939317046, 70.86139106984504, 55.10800779391005, 1433630444.12308, 174161495063.4697, 32410244556.9514, 53050.0, 4.56130833333333, 4.328097687190846),
  c(89287.45401841149, 90.63795175603656, 54.29501613613857, 3736886589.35297, 51552075901.51828, 16145878199.0284, 70560.0, 5.25, -2.298559451341097),
  c(23838.61439793707, 156.9825935699502, 22.98259537893911, 510408456.722476, 10154463059.24606, 596933291.286177, 22680.0, 4.705, 2.695332567172033), 
  c(25025.09956290829, 68.57822982038519, 1.366142826228091, 226371388.826816, 2581564245.810056, 653170670.0, 23970.0, 8.5, 10.99997995126551), 
  c(7875.756952542878, 48.41583307552164, 42.16728076638825, 2619437000.0, 74164435946.46272, 15175667724.097, 7410.0, 18.21, 17.7227825311853), 
  c(1449.605912338698, 25.43086130051905, 34.30465633300208, 28153031270.3203, 1856722121394.535, 298092478740.581, 1520.0, 10.2916666666667, 3.865992862708711),
  c(12300.32257522326, 11.74223284563898, 18.33663102034147, 75211028087.44, 2472806456101.294, 358816422466.118, 12810.0, 27.3916666666667, 18.49891574867216), 
  c(9637.00265000958, 48.41741474823912, 18.07151549645933, 293341671.7153, 12129642296.44251, 3490767903.76468, 10520.0, 8.5, 5.595201539718113),
  c(9555.244217331405, 39.87312171320465, 24.52245846262788, 3854819397.63757, 190949066979.1761, 48827640845.6875, 9250.0, 10.5225, 6.896313251618643), 
  c(6756.752769265565, 24.80829942085084, 21.91445645110553, 9826002544.00792, 201175469114.3269, 65766067276.3127, 6420.0, 18.13925, 16.90330806905899),
  c(6832.456890967005, 30.97134112327325, 15.36216988329349, 8232518815.62083, 366829390478.9538, 49708174893.5691, 7350.0, 8.5, 2.208786248393751), 
  c(6168.26489540709, 68.116149065726, 27.53306877934283, 15935960663.1, 420333333333.3334, 167230223498.308, 5720.0, 5.06043360051236, 3.224153350189769), 
  c(5694.082634284248, 41.18507314971835, 19.75562267717507, 787993184.247365, 12717790504.50021, 1511161812.62397, 6020.0, 8.28916666666667, -0.4661456540828975), 
  c(49522.23696658865, 53.49303770656009, 17.71787120237939, 472607545.774898, 16033517529.25061, 4237652258.59372, 46960.0, 8.15166666666667, 5.882699337840028), 
  c(7646.839865545417, 64.8781363714651, 24.06997120419808, 1989040000.0, 55555171009.77199, 19883353048.1463, 7590.0, 9.04340833333333, 9.815306625039884), 
  c(3623.911582351342, 23.92357637936048, 31.12176664001678, 23281742361.5305, 912524136718.0182, 99386826239.0833, 3730.0, 11.6575, 6.374931242121366), 
  c(7186.431924061808, 41.34234770624794, 8.21972941238063, 446490330.272441, 4464261816.250664, 583975007.21015, 7330.0, 9.36, 7.14534037938192), 
  c(3838.185801483817, 28.35912649955389, 14.45467947820117, 346092394.393256, 11121465767.40668, 2251610255.35403, 4110.0, 15.9949873679769, 12.2168430436348), 
  c(6639.607145950244, 26.08096504832431, -1.539765054486815, 126735012.962963, 721207407.4074074, 135096711.23141, 6420.0, 9.43978132892116, 7.076556902552543), 
  c(3452.922000495893, 23.71968813417143, 12.27434207201931, 1353141908.0, 53851153446.69585, 7269204343.62926, 3320.0, 13.5975, 9.89784989269058), 
  c(2998.072842641175, 18.04990658454376, 18.10071244054618, 5562873605.73813, 514966287334.2775, 46254763637.5804, 2720.0, 16.7225, 11.20162222488215), 
  c(13642.19778327002, 40.43457743159834, 17.77169918160843, 937309759.586375, 58056951042.08662, 17766773440.2298, 13520.0, 9.24666666666667, 8.417903769961924), 
  c(1886.671896336714, 83.62614116936763, 29.63653298966147, 8900000000.0, 171222025117.3809, 25893489673.0736, 1720.0, 10.3741666666667, 5.358416129905779), 
  c(4623.729553889743, 41.72175007869059, 15.50504359523593, 1028019553.35, 17189491403.15017, 2823383516.08606, 4530.0, 13.5948916043986, 12.06330049658788),
  c(6238.133097016758, 25.16715872602312, 18.25124303400052, 1599900000.0, 62682158700.63812, 4700626508.01792, 6030.0, 13.5914005366949, 8.499705577146024),
  c(13687.24610128104, 85.58445077202369, 24.38009682050063, -3772123439.3159, 135409048034.1537, 46508013997.58, 13480.0, 6.30391235390833, 3.22918038789386)
)

rownames(performanceTable) <- c("Malaysia", "Japan", "Botswana", "Chile", "Oman", "China", "Israel", "Canada", "Czech Republic", "United States", "Kwait",
                                "Macao_SAR_China","Malta", "Aruba","Azerbaijan", "India", "Brazil", "Mauritius", "Romania", "Peru", "South Africa", "Thailand",
                                "Namibia", "Iceland", "Bulgaria","Indonesia", "Montenegro", "Armenia", "St. Vincent and the Grenadines", "Guatemala", "Nigeria", "Vietnam", "Kenya",
                                "Georgia", "Dominican Republic","Hungary")
colnames(performanceTable) <- colnames(performanceTable_test)

# ranks of the alternatives
Assignments <- c(1,1,1,1,1,1,1,1,1,1,1,1,
                 2,2,2,2,2,2,2,2,2,2,2,2,
                 3,3,3,3,3,3,3,3,3,3,3,3)
names(Assignments) <- rownames(performanceTable)

#criteria to max or to min
criteriaMinMax <- c("max","max","max","max","max","max","max","min","min")
names(criteriaMinMax) <- colnames(performanceTable_test)

# ranks of the categories
categoriesRanks <- c(1,2,3)
names(categoriesRanks) <- c(1,2,3)

Parameters <- MRSortInferenceApprox(performanceTable, Assignments, categoriesRanks, criteriaMinMax,
                                    veto = FALSE, alternativesIDs = NULL, criteriaIDs = NULL,
                                    timeLimit = 60, populationSize = 20, mutationProb = 0.1)


# Aqui, entra as alternativas para serem classificadas!
# Precisa mudar a PerformanceTable
# performance table

x <- MRSort(performanceTable_test, Parameters$profilesPerformances, 
            categoriesRanks, Parameters$criteriaWeights, criteriaMinMax,
            Parameters$majorityThreshold, criteriaVetos = NULL,
            alternativesIDs = NULL, criteriaIDs = NULL,
            categoriesIDs = NULL)

x
clsf_table <- rbind(x)
clsf_table <- t(clsf_table)

